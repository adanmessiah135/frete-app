-- Excluir o banco de dados existente (se existir)
DROP DATABASE IF EXISTS frete_db;

-- Criar o banco de dados
CREATE DATABASE frete_db;
USE frete_db;

-- Criar a tabela frete
CREATE TABLE frete (
    id INT AUTO_INCREMENT PRIMARY KEY,
    origem VARCHAR(255),
    uf_origem CHAR(2),
    destino VARCHAR(255),
    distancia INT,
    tarifa DECIMAL(10, 2)
);
INSERT INTO frete (origem, uf_origem, destino, distancia, tarifa) VALUES
('BEBEDOURO', 'SP', 'CAMBIRA', 510.0, 704.55),
('BEBEDOURO', 'SP', 'PARANAIBA', 375.0, 485.1),
('BEBEDOURO', 'SP', 'CHAPADAO DO SUL', 568.0, 837.38),
('BEBEDOURO', 'SP', 'ITUPEVA', 323.0, 360.68),
('BEBEDOURO', 'SP', 'JACI', 141.0, 203.11),
('BEBEDOURO', 'SP', 'COLOMBO', 765.0, 981.75),
('BEBEDOURO', 'SP', 'MIGUELOPOLIS', 124.0, 213.68),
('BEBEDOURO', 'SP', 'REGENTE FEIJO', 374.0, 479.33),
('BEBEDOURO', 'SP', 'JAMBEIRO', 472.0, 681.45),
('BEBEDOURO', 'SP', 'NOVA MUTUM', 1487.0, 2061.68),
('BEBEDOURO', 'SP', 'VITORINO', 1004.0, 1328.54),
('BEBEDOURO', 'SP', 'PAULINIA', 282.0, 479.33),
('BEBEDOURO', 'SP', 'ESTRELA', 1431.0, 2047.03),
('BEBEDOURO', 'SP', 'ALTAMIRA', 2484.0, 3294.06),
('BEBEDOURO', 'SP', 'AGROLANDIA', 1072.0, 1518.66),
('BEBEDOURO', 'SP', 'TIMOTEO', 790.0, 938.44),
('BEBEDOURO', 'SP', 'MANAUS', 3583.0, 4287.89),
('BEBEDOURO', 'SP', 'DOBRADA', 76.0, 167.47),
('BEBEDOURO', 'SP', 'BIGUACU', 1031.0, 1334.55),
('BEBEDOURO', 'SP', 'BETIM', 565.0, 710.65),
('BEBEDOURO', 'SP', 'BELO HORIZONTE', 604.0, 753.38),
('BEBEDOURO', 'SP', 'CONTAGEM', 607.0, 825.83),
('BEBEDOURO', 'SP', 'ITARARE', 442.0, 522.06),
('BEBEDOURO', 'SP', 'CANELA', 1457.0, 1980.83),
('BEBEDOURO', 'SP', 'TUNAS DO PARANA', 611.0, 753.06),
('BEBEDOURO', 'SP', 'BOM JESUS DOS PERDOES', 364.0, 456.52),
('BEBEDOURO', 'SP', 'SAO PEDRO DO TURVO', 338.0, 453.23),
('BEBEDOURO', 'SP', 'PIRAPORA DO BOM JESUS', 373.0, 476.29),
('BEBEDOURO', 'SP', 'PRESIDENTE FIGUEIREDO', 3707.0, 4911.06),
('BEBEDOURO', 'SP', 'RIO NEGRO', 871.0, 1056.83),
('BEBEDOURO', 'SP', 'BARRINHA', 67.0, 86.63),
('BEBEDOURO', 'SP', 'POCOS DE CALDA', 278.0, 358.05),
('BEBEDOURO', 'SP', 'SAQUAREMA', 878.0, 1053.36),
('BEBEDOURO', 'SP', 'ITAPOA', 880.0, 1051.05),
('BEBEDOURO', 'SP', 'ARCOS', 398.0, 467.78),
('BEBEDOURO', 'SP', 'AGUAI', 243.0, 306.08),
('BEBEDOURO', 'SP', 'BENEVIDES', 2500.0, 2905.5),
('BEBEDOURO', 'SP', 'CAJAMAR', 350.0, 445.71),
('BEBEDOURO', 'SP', 'SAO JOSE DOS PINHAIS', 780.0, 915.43),
('BEBEDOURO', 'SP', 'CURITIBA', 763.0, 895.13),
('BEBEDOURO', 'SP', 'CAMPO MOURAO', 639.0, 779.63),
('BEBEDOURO', 'SP', 'SAO GABRIEL DO OESTE', 857.0, 1051.05),
('BEBEDOURO', 'SP', 'BARRA DO CHAPEU', 546.0, 675.68),
('BEBEDOURO', 'SP', 'BRASILEIA', 3419.0, 4060.42),
('BEBEDOURO', 'SP', 'CARLOPOLIS', 400.0, 476.15),
('BEBEDOURO', 'SP', 'SALES OLIVEIRA', 80.0, 164.82),
('BEBEDOURO', 'SP', 'IRACEMAPOLIS', 234.0, 479.33),
('BEBEDOURO', 'SP', 'BOITUVA', 327.0, 437.02),
('BEBEDOURO', 'SP', 'CAMACARI', 1829.0, 2483.54),
('BEBEDOURO', 'SP', 'OSASCO', 377.0, 554.75),
('BEBEDOURO', 'SP', 'LAURO DE FREITAS', 1834.0, 2492.28),
('BEBEDOURO', 'SP', 'ARACOIABA DA SERRA', 391.0, 473.55),
('BEBEDOURO', 'SP', 'ALVINOPOLIS', 745.0, 941.33),
('BEBEDOURO', 'SP', 'AMERICO BRASILIENSE', 157.0, 185.33),
('BEBEDOURO', 'SP', 'ANAPOLIS', 854.0, 1084.41),
('BEBEDOURO', 'SP', 'TERENOS', 777.0, 935.84),
('BEBEDOURO', 'SP', 'ANDRADINA', 373.0, 404.54),
('BEBEDOURO', 'SP', 'APARECIDA DE GOIANIA', 505.0, 866.54),
('BEBEDOURO', 'SP', 'APARECIDA DO TABOADO', 325.0, 564.74),
('BEBEDOURO', 'SP', 'ARACATUBA', 273.0, 324.47),
('BEBEDOURO', 'SP', 'UCHOA', 93.0, 141.32),
('BEBEDOURO', 'SP', 'CAFELANDIA', 203.0, 301.2),
('BEBEDOURO', 'SP', 'ARAGUAINA', 1696.0, 2114.39),
('BEBEDOURO', 'SP', 'URUSSANGA', 1222.0, 1568.99),
('BEBEDOURO', 'SP', 'JUNDIAI', 327.0, 530.03),
('BEBEDOURO', 'SP', 'MARILIA', 254.0, 279.69),
('BEBEDOURO', 'SP', 'SEBASTIANOPOLIS DO SUL', 182.0, 204.82),
('BEBEDOURO', 'SP', 'SAO DESIDERIO', 1315.0, 1762.18),
('BEBEDOURO', 'SP', 'NOVA BRASILANDIA DO OESTE', 2297.0, 2830.78),
('BEBEDOURO', 'SP', 'CAMBUI', 439.0, 670.48),
('BEBEDOURO', 'SP', 'SAO JOAQUIM DE BICAS', 564.0, 707.56),
('BEBEDOURO', 'SP', 'CACOAL', 2215.0, 2838.26),
('BEBEDOURO', 'SP', 'ARAGUARI', 319.0, 476.87),
('BEBEDOURO', 'SP', 'ARARAQUARA', 113.0, 118.34),
('BEBEDOURO', 'SP', 'ARARAS', 228.0, 358.4),
('BEBEDOURO', 'SP', 'ARCEBURGO', 205.0, 289.74),
('BEBEDOURO', 'SP', 'ASSIS CHATEAUBRIAND', 781.0, 964.91),
('BEBEDOURO', 'SP', 'BARRA BONITA', 204.0, 248.46),
('BEBEDOURO', 'SP', 'BARRETOS', 49.0, 61.75),
('BEBEDOURO', 'SP', 'BATATAIS', 123.0, 126.54),
('BEBEDOURO', 'SP', 'BEBEDOURO', 25.0, 29.17),
('BEBEDOURO', 'SP', 'BENTO DE ABREU', 302.0, 359.57),
('BEBEDOURO', 'SP', 'BIRIGUI', 245.0, 291.35),
('BEBEDOURO', 'SP', 'BOA VISTA', 4349.0, 6305.03),
('BEBEDOURO', 'SP', 'BRASILIA', 713.0, 1074.68),
('BEBEDOURO', 'SP', 'BROTAS', 127.0, 156.68),
('BEBEDOURO', 'SP', 'CAJURU', 142.0, 147.44),
('BEBEDOURO', 'SP', 'CAMANDUCAIA', 419.0, 618.95),
('BEBEDOURO', 'SP', 'CAMPINAS', 302.0, 387.16),
('BEBEDOURO', 'SP', 'CAMPO GRANDE', 745.0, 1138.41),
('BEBEDOURO', 'SP', 'CAMPO VERDE', 1151.0, 2605.26),
('BEBEDOURO', 'SP', 'CASCAVEL', 937.0, 1338.41),
('BEBEDOURO', 'SP', 'CATALAO', 399.0, 595.96),
('BEBEDOURO', 'SP', 'CATANDUVA', 67.0, 62.11),
('BEBEDOURO', 'SP', 'CEDRAL', 109.0, 113.4),
('BEBEDOURO', 'SP', 'COLOMBIA', 92.0, 100.64),
('BEBEDOURO', 'SP', 'CORONEL FREITAS', 1100.0, 1565.03),
('BEBEDOURO', 'SP', 'CRAVINHOS', 103.0, 106.79),
('BEBEDOURO', 'SP', 'DIADEMA', 417.0, 552.09),
('BEBEDOURO', 'SP', 'DOURADOS', 834.0, 1104.01),
('BEBEDOURO', 'SP', 'DRACENA', 245.0, 434.05),
('BEBEDOURO', 'SP', 'ELISIARIO', 76.0, 127.34),
('BEBEDOURO', 'SP', 'ESPIRITO SANTO DO PINHAL', 273.0, 410.93),
('BEBEDOURO', 'SP', 'EUSEBIO', 2798.0, 3760.56),
('BEBEDOURO', 'SP', 'FRANCA', 169.0, 179.26),
('BEBEDOURO', 'SP', 'GOIANIA', 524.0, 753.29),
('BEBEDOURO', 'SP', 'GUAPIACU', 93.0, 175.91),
('BEBEDOURO', 'SP', 'GUARA', 317.0, 317.99),
('BEBEDOURO', 'SP', 'GUARIBA', 65.0, 60.32),
('BEBEDOURO', 'SP', 'GUARULHOS', 410.0, 485.39),
('BEBEDOURO', 'SP', 'IACRI', 297.0, 456.82),
('BEBEDOURO', 'SP', 'IBATE', 136.0, 144.9),
('BEBEDOURO', 'SP', 'IGARAPAVA', 158.0, 173.37),
('BEBEDOURO', 'SP', 'INDAIATUBA', 313.0, 375.99),
('BEBEDOURO', 'SP', 'INHUMAS', 576.0, 786.5),
('BEBEDOURO', 'SP', 'IPAUSSU', 336.0, 375.99),
('BEBEDOURO', 'SP', 'ITABORAI', 822.0, 1273.52),
('BEBEDOURO', 'SP', 'ITAJUBA', 446.0, 682.44),
('BEBEDOURO', 'SP', 'ITAMBE', 2599.0, 3216.81),
('BEBEDOURO', 'SP', 'ITAPIRA', 303.0, 344.77),
('BEBEDOURO', 'SP', 'ITAPOLIS', 108.0, 168.05),
('BEBEDOURO', 'SP', 'ITAQUAQUECETUBA', 428.0, 675.91),
('BEBEDOURO', 'SP', 'ITATIBA', 335.0, 476.21),
('BEBEDOURO', 'SP', 'ITUMBIARA', 320.0, 476.44),
('BEBEDOURO', 'SP', 'ITUVERAVA', 158.0, 167.91),
('BEBEDOURO', 'SP', 'JABOTICABAL', 43.0, 44.88),
('BEBEDOURO', 'SP', 'JARDINOPOLIS', 102.0, 109.0),
('BEBEDOURO', 'SP', 'JAU', 181.0, 206.7),
('BEBEDOURO', 'SP', 'JOSE BONIFACIO', 159.0, 249.45),
('BEBEDOURO', 'SP', 'LIMEIRA', 250.0, 295.44),
('BEBEDOURO', 'SP', 'LINS', 224.0, 273.24),
('BEBEDOURO', 'SP', 'LONDRINA', 453.0, 676.71),
('BEBEDOURO', 'SP', 'LUZIANIA', 659.0, 922.31),
('BEBEDOURO', 'SP', 'MANDAGUACU', 564.0, 861.17),
('BEBEDOURO', 'SP', 'MANDAGUARI', 523.0, 761.03),
('BEBEDOURO', 'SP', 'MARACAI', 351.0, 409.2),
('BEBEDOURO', 'SP', 'MARIALVA', 533.0, 603.55),
('BEBEDOURO', 'SP', 'MARINGA', 539.0, 598.72),
('BEBEDOURO', 'SP', 'MATAO', 83.0, 78.35),
('BEBEDOURO', 'SP', 'MATELANDIA', 882.0, 1107.62),
('BEBEDOURO', 'SP', 'MINEIROS', 959.0, 1332.2),
('BEBEDOURO', 'SP', 'MIRASSOL', 140.0, 176.34),
('BEBEDOURO', 'SP', 'MOCOCA', 190.0, 232.45),
('BEBEDOURO', 'SP', 'MOGI DAS CRUZES', 437.0, 784.01),
('BEBEDOURO', 'SP', 'MOGI GUACU', 276.0, 408.45),
('BEBEDOURO', 'SP', 'MONTE ALTO', 57.0, 83.62),
('BEBEDOURO', 'SP', 'MONTE AZUL PAULISTA', 20.0, 23.22),
('BEBEDOURO', 'SP', 'MORRO AGUDO', 55.0, 60.41),
('BEBEDOURO', 'SP', 'NEVES PAULISTA', 146.0, 178.88),
('BEBEDOURO', 'SP', 'OLIMPIA', 55.0, 49.21),
('BEBEDOURO', 'SP', 'ORLANDIA', 83.0, 83.34),
('BEBEDOURO', 'SP', 'OURINHOS', 346.0, 522.82),
('BEBEDOURO', 'SP', 'PADRE BERNARDO', 787.0, 1127.05),
('BEBEDOURO', 'SP', 'PAICANDU', 563.0, 789.11),
('BEBEDOURO', 'SP', 'PALMAS', 1409.0, 1895.19),
('BEBEDOURO', 'SP', 'PARANAVAI', 646.0, 835.84),
('BEBEDOURO', 'SP', 'PARAPUA', 304.0, 485.51),
('BEBEDOURO', 'SP', 'PATOS DE MINAS', 454.0, 692.8),
('BEBEDOURO', 'SP', 'PENAPOLIS', 227.0, 345.08),
('BEBEDOURO', 'SP', 'PINDORAMA', 64.0, 91.13),
('BEBEDOURO', 'SP', 'PINHAIS', 770.0, 930.13),
('BEBEDOURO', 'SP', 'PIRACICABA', 245.0, 277.53),
('BEBEDOURO', 'SP', 'PIRANGI', 35.0, 46.57),
('BEBEDOURO', 'SP', 'PITANGUEIRAS', 30.0, 37.86),
('BEBEDOURO', 'SP', 'POMPEIA', 245.0, 348.12),
('BEBEDOURO', 'SP', 'PONTA GROSSA', 700.0, 849.83),
('BEBEDOURO', 'SP', 'PONTAL', 62.0, 72.71),
('BEBEDOURO', 'SP', 'PRADOPOLIS', 73.0, 97.0),
('BEBEDOURO', 'SP', 'PRATA', 225.0, 330.21),
('BEBEDOURO', 'SP', 'RAFARD', 285.0, 364.17),
('BEBEDOURO', 'SP', 'RIBEIRAO PRETO', 80.0, 87.03),
('BEBEDOURO', 'SP', 'RIO DAS PEDRAS', 260.0, 364.35),
('BEBEDOURO', 'SP', 'RIO VERDE', 522.0, 598.72),
('BEBEDOURO', 'SP', 'ROLANDIA', 462.0, 751.28),
('BEBEDOURO', 'SP', 'RONDONOPOLIS', 1019.0, 1415.37),
('BEBEDOURO', 'SP', 'SANTA ADELIA', 57.0, 73.79),
('BEBEDOURO', 'SP', "SANTA BARBARA D'OESTE", 266.0, 398.96),
('BEBEDOURO', 'SP', 'SANTA CRUZ DA ESPERANCA', 128.0, 151.48),
('BEBEDOURO', 'SP', 'SANTA ROSA DE VITERBO', 154.0, 171.58),
('BEBEDOURO', 'SP', 'SANTA TEREZA DO OESTE', 834.0, 988.43),
('BEBEDOURO', 'SP', 'SANTO ANDRE', 402.0, 489.32),
('BEBEDOURO', 'SP', 'SAO CARLOS', 149.0, 187.64),
('BEBEDOURO', 'SP', 'SAO JOAO DA BOA VISTA', 252.0, 280.09),
('BEBEDOURO', 'SP', 'SAO JOSE DO RIO PARDO', 209.0, 233.14),
('BEBEDOURO', 'SP', 'SAO JOSE DO RIO PRETO', 123.0, 138.43),
('BEBEDOURO', 'SP', 'SAO MIGUEL DO IGUACU', 911.0, 1273.37),
('BEBEDOURO', 'SP', 'SAO PAULO', 395.0, 595.19),
('BEBEDOURO', 'SP', 'SAO SEBASTIAO DO PARAISO', 192.0, 210.5),
('BEBEDOURO', 'SP', 'SARANDI', 542.0, 553.08),
('BEBEDOURO', 'SP', 'SERTAOZINHO', 60.0, 60.09),
('BEBEDOURO', 'SP', 'SEVERINIA', 38.0, 46.56),
('BEBEDOURO', 'SP', 'SIQUEIRA CAMPOS', 455.0, 692.66),
('BEBEDOURO', 'SP', 'SOROCABA', 348.0, 510.96),
('BEBEDOURO', 'SP', 'TABAPUA', 93.0, 108.71),
('BEBEDOURO', 'SP', 'TABATINGA', 114.0, 145.07),
('BEBEDOURO', 'SP', 'TAMBAU', 178.0, 222.03),
('BEBEDOURO', 'SP', 'TRES LAGOAS', 414.0, 474.08),
('BEBEDOURO', 'SP', 'TUPA', 320.0, 361.26),
('BEBEDOURO', 'SP', 'VALENTIM GENTIL', 212.0, 232.53),
('BEBEDOURO', 'SP', 'VARGEM GRANDE DO SUL', 233.0, 292.09),
('BEBEDOURO', 'SP', 'VARZEA GRANDE', 1246.0, 1559.73),
('BEBEDOURO', 'SP', 'VILHENA', 1993.0, 2714.78),
('BEBEDOURO', 'SP', 'VISTA ALEGRE DO ALTO', 48.0, 49.91),
('BEBEDOURO', 'SP', 'VOTUPORANGA', 195.0, 227.67);

SELECT COUNT(*) FROM frete;



-- Adicionar a coluna id_veiculo e a chave estrangeira
ALTER TABLE frete ADD COLUMN id_veiculo INT;
ALTER TABLE frete ADD FOREIGN KEY (id_veiculo) REFERENCES tipos_veiculo(id);

LOAD DATA INFILE "D:\PROJETO BD PRADA\FRETE.csv"
INTO TABLE frete
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS
(origem, uf_origem, destino, distancia, tarifa);

SELECT COUNT(*) FROM frete;
-- Criar a tabela tipos_veiculo
CREATE TABLE tipos_veiculo (
    id INT AUTO_INCREMENT PRIMARY KEY,
    tipo VARCHAR(255),
    lotacao_minima DECIMAL(10, 3),
    lotacao_maxima DECIMAL(10, 3),
    peso_minimo DECIMAL(10, 3)
);

-- Inserir os tipos de veículo
INSERT INTO tipos_veiculo (tipo, lotacao_minima, lotacao_maxima, peso_minimo) VALUES
    ('TOCO', 0.250, 6.900, 5.000),
    ('TRUCK', 7.000, 14.000, 11.000),
    ('BITRUCK', 14.010, 21.000, 16.000),
    ('CARRETA', 21.010, 27.000, 23.000),
    ('TRUCADA', 27.010, 32.000, 28.000),
    ('VANDERLEIA', 32.010, 36.000, 31.000),
    ('BITREM', 36.010, 40.000, 36.000),
    ('RODOTREM', 40.010, 52.000, 45.000);

-- Adicionar a categoria INTERMEDIARIO (necessária para os testes anteriores)
INSERT INTO tipos_veiculo (id, tipo, lotacao_minima, lotacao_maxima, peso_minimo) 
VALUES (9, 'INTERMEDIARIO', 7.000, 14.000, 13.152);

-- Verificar os dados inseridos
TRUNCATE TABLE frete;
    
    



